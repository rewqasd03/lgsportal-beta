(()=>{var e={};e.id=909,e.ids=[909],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},83547:e=>{"use strict";e.exports=import("@react-pdf/renderer")},23745:e=>{"use strict";e.exports=import("firebase/app")},60401:e=>{"use strict";e.exports=import("firebase/auth")},1492:e=>{"use strict";e.exports=import("firebase/firestore")},39904:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(44837),s(46005),s(35866);var r=s(23191),a=s(88716),l=s(37922),n=s.n(l),i=s(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["student-dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,44837)),"/workspace/src/app/student-dashboard/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,46005)),"/workspace/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/workspace/src/app/student-dashboard/page.tsx"],x="/student-dashboard/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/student-dashboard/page",pathname:"/student-dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},39776:(e,t,s)=>{Promise.resolve().then(s.bind(s,14506))},57130:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Z:()=>o});var a=s(10326);s(17577);var l=s(83547),n=e([l]);(l=(n.then?(await n)():n)[0]).Font.register({family:"Open Sans",fonts:[{src:"https://fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObjxOVQA-O.woff2",fontWeight:400},{src:"https://fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObjxOVQA-O.woff2",fontWeight:600},{src:"https://fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObjxOVQA-O.woff2",fontWeight:"bold"}]});let i=l.StyleSheet.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:35,fontFamily:"Open Sans",fontSize:11,lineHeight:1.6},header:{flexDirection:"row",alignItems:"center",marginBottom:25,borderBottomWidth:3,borderBottomColor:"#1E40AF",paddingBottom:15},logoContainer:{width:55,height:55,backgroundColor:"#EFF6FF",borderRadius:10,justifyContent:"center",alignItems:"center",marginRight:15},logoText:{fontSize:24,color:"#1E40AF"},headerText:{flex:1},title:{fontSize:22,fontWeight:"bold",color:"#000000",marginBottom:5},subtitle:{fontSize:13,color:"#555555"},section:{marginBottom:20},sectionTitle:{fontSize:16,fontWeight:"bold",color:"#1E40AF",marginBottom:12,paddingBottom:6,borderBottomWidth:2,borderBottomColor:"#BFDBFE"},card:{backgroundColor:"#F8FAFC",borderRadius:8,padding:15,marginBottom:12,borderWidth:1,borderColor:"#E2E8F0"},cardRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#E2E8F0"},cardRowLast:{marginBottom:0,paddingBottom:0,borderBottomWidth:0},cardLabel:{fontSize:11,color:"#555555"},cardValue:{fontSize:13,fontWeight:"bold",color:"#000000"},grid:{flexDirection:"row",flexWrap:"wrap",gap:12},gridItem:{width:"48%",backgroundColor:"#EFF6FF",padding:15,borderRadius:8,marginBottom:10,borderWidth:1,borderColor:"#BFDBFE"},statValue:{fontSize:24,fontWeight:"bold",color:"#1E40AF"},statLabel:{fontSize:10,color:"#555555",marginTop:4,textTransform:"uppercase",letterSpacing:.5},table:{width:"100%",borderWidth:2,borderColor:"#1E40AF",borderRadius:6,overflow:"hidden",marginBottom:12},tableRow:{flexDirection:"row"},tableHeader:{backgroundColor:"#1E40AF"},tableHeaderCell:{padding:12,fontSize:10,fontWeight:"bold",color:"#FFFFFF",textAlign:"center"},tableCell:{padding:10,fontSize:10,color:"#000000",borderBottomWidth:1,borderBottomColor:"#E2E8F0",textAlign:"center"},tableCellFirst:{textAlign:"left",fontWeight:"600"},progressBar:{height:10,backgroundColor:"#E2E8F0",borderRadius:5,overflow:"hidden",marginTop:6},progressFill:{height:"100%",borderRadius:5},footer:{position:"absolute",bottom:25,left:35,right:35,textAlign:"center",fontSize:9,color:"#666666",borderTopWidth:1,borderTopColor:"#E2E8F0",paddingTop:10},chartImage:{width:"100%",height:220,marginVertical:12,borderRadius:6,borderWidth:1,borderColor:"#E2E8F0"},infoBox:{backgroundColor:"#FEF3C7",borderRadius:6,padding:12,marginBottom:10,borderWidth:1,borderColor:"#FCD34D"},infoText:{fontSize:10,color:"#92400E"},subjectCard:{backgroundColor:"#F8FAFC",borderRadius:6,padding:12,marginBottom:8,borderWidth:1,borderColor:"#E2E8F0"},subjectHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:6},subjectName:{fontSize:14,fontWeight:"bold",color:"#000000"},subjectScore:{fontSize:16,fontWeight:"bold",color:"#1E40AF"},subjectProgress:{height:8,backgroundColor:"#E2E8F0",borderRadius:4,overflow:"hidden"},subjectProgressFill:{height:"100%",borderRadius:4},subjectFooter:{flexDirection:"row",justifyContent:"space-between",marginTop:6},subjectLabel:{fontSize:9,color:"#555555"},subjectStatus:{fontSize:9,fontWeight:"bold"}}),o=({reportData:e,chartImage:t})=>{if(!e)return null;let{student:s,examResults:r}=e,n=r.filter(e=>e.studentTotalNet>0),o=n.reduce((e,t)=>e+t.studentTotalNet,0),d=n.length>0?o/n.length:0,c=n.length>0&&n[n.length-1]?.studentTotalNet||0,x=n.length>1&&n[n.length-2]?.studentTotalNet||0,m=c-x,u=r.length>0?r.reduce((e,t)=>e+(t.classAverage||0),0)/r.length:0,h=n.length>0?n.reduce((e,t)=>e+(t.studentTotalScore||0),0)/n.length:0,g=r.length>0?r.reduce((e,t)=>e+(t.classAverageScore||0),0)/r.length:0,p=(()=>{if(!r||0===r.length)return 0;let e=[...r].sort((e,t)=>new Date(t.exam.date).getTime()-new Date(e.exam.date).getTime())[0].studentResults[0];if(!e)return 0;let t=e.puan;return t&&"string"==typeof t&&(t=parseFloat(t)),!t&&e.scores?.puan&&(t=e.scores.puan,"string"==typeof t&&(t=parseFloat(t))),!t&&e.totalScore&&(t=e.totalScore,"string"==typeof t&&(t=parseFloat(t))),!t&&e.nets?.total&&(t=5*e.nets.total),Math.round(t||0)})();return(0,a.jsxs)(l.Document,{children:[(0,a.jsxs)(l.Page,{size:"A4",style:i.page,children:[(0,a.jsxs)(l.View,{style:i.header,children:[a.jsx(l.View,{style:i.logoContainer,children:a.jsx(l.Text,{style:i.logoText,children:"\uD83D\uDCCA"})}),(0,a.jsxs)(l.View,{style:i.headerText,children:[a.jsx(l.Text,{style:i.title,children:"LGS Portalı - \xd6ğrenci Raporu"}),(0,a.jsxs)(l.Text,{style:i.subtitle,children:[s.name," - ",s.class]})]})]}),(0,a.jsxs)(l.View,{style:i.section,children:[a.jsx(l.Text,{style:i.sectionTitle,children:"\uD83D\uDCCA Genel Performans \xd6zeti"}),(0,a.jsxs)(l.View,{style:i.grid,children:[(0,a.jsxs)(l.View,{style:i.gridItem,children:[a.jsx(l.Text,{style:i.statValue,children:(d||0).toFixed(1)}),a.jsx(l.Text,{style:i.statLabel,children:"Ortalama Net"})]}),(0,a.jsxs)(l.View,{style:i.gridItem,children:[a.jsx(l.Text,{style:i.statValue,children:(c||0).toFixed(1)}),a.jsx(l.Text,{style:i.statLabel,children:"Son Net"})]}),(0,a.jsxs)(l.View,{style:i.gridItem,children:[(0,a.jsxs)(l.Text,{style:[i.statValue,{color:m>=0?"#16A34A":"#DC2626"}],children:[(m||0)>=0?"+":"",(m||0).toFixed(1)]}),a.jsx(l.Text,{style:i.statLabel,children:"Değişim"})]}),(0,a.jsxs)(l.View,{style:i.gridItem,children:[a.jsx(l.Text,{style:i.statValue,children:r.length}),a.jsx(l.Text,{style:i.statLabel,children:"Toplam Deneme"})]})]})]}),(0,a.jsxs)(l.View,{style:i.section,children:[a.jsx(l.Text,{style:i.sectionTitle,children:"\uD83D\uDCC8 Sınıf Karşılaştırması"}),(0,a.jsxs)(l.View,{style:i.card,children:[(0,a.jsxs)(l.View,{style:i.cardRow,children:[a.jsx(l.Text,{style:i.cardLabel,children:"Ortalama Net (Sınıf Ortalaması)"}),a.jsx(l.Text,{style:i.cardValue,children:(u||0).toFixed(1)})]}),(0,a.jsxs)(l.View,{style:i.cardRow,children:[a.jsx(l.Text,{style:i.cardLabel,children:"Ortalama Puan (Sizin)"}),a.jsx(l.Text,{style:i.cardValue,children:(h||0).toFixed(0)})]}),(0,a.jsxs)(l.View,{style:[i.cardRow,i.cardRowLast],children:[a.jsx(l.Text,{style:i.cardLabel,children:"Ortalama Puan (Sınıf)"}),a.jsx(l.Text,{style:i.cardValue,children:(g||0).toFixed(0)})]})]})]}),t&&(0,a.jsxs)(l.View,{style:i.section,children:[a.jsx(l.Text,{style:i.sectionTitle,children:"\uD83D\uDCC8 Net Gelişim Trendi"}),a.jsx(l.Image,{src:t,style:i.chartImage})]}),(0,a.jsxs)(l.View,{style:i.section,children:[a.jsx(l.Text,{style:i.sectionTitle,children:"\uD83D\uDCDA Deneme Ge\xe7mişi"}),(0,a.jsxs)(l.View,{style:i.table,children:[(0,a.jsxs)(l.View,{style:[i.tableRow,i.tableHeader],children:[a.jsx(l.Text,{style:[i.tableHeaderCell,{width:"40%",textAlign:"left",paddingLeft:12}],children:"Deneme Adı"}),a.jsx(l.Text,{style:[i.tableHeaderCell,{width:"20%"}],children:"Netiniz"}),a.jsx(l.Text,{style:[i.tableHeaderCell,{width:"20%"}],children:"Sınıf Ort."}),a.jsx(l.Text,{style:[i.tableHeaderCell,{width:"20%"}],children:"Genel Ort."})]}),r.slice(0,10).map((e,t)=>(0,a.jsxs)(l.View,{style:i.tableRow,children:[a.jsx(l.Text,{style:[i.tableCell,{width:"40%",textAlign:"left",paddingLeft:12}],children:e.exam.title}),a.jsx(l.Text,{style:[i.tableCell,{width:"20%"}],children:e.studentTotalNet>0?e.studentTotalNet.toFixed(1):"-"}),a.jsx(l.Text,{style:[i.tableCell,{width:"20%"}],children:e.classAverage.toFixed(1)}),a.jsx(l.Text,{style:[i.tableCell,{width:"20%"}],children:e.generalAverage.toFixed(1)})]},t))]}),r.length>10&&(0,a.jsxs)(l.Text,{style:{fontSize:10,color:"#666666",textAlign:"center",marginTop:8},children:["...ve ",r.length-10," deneme daha"]})]}),(0,a.jsxs)(l.Text,{style:i.footer,children:["LGS Portalı - Rapor Tarihi: ",new Date().toLocaleDateString("tr-TR")]})]}),(0,a.jsxs)(l.Page,{size:"A4",style:i.page,children:[(0,a.jsxs)(l.View,{style:i.header,children:[a.jsx(l.View,{style:i.logoContainer,children:a.jsx(l.Text,{style:i.logoText,children:"\uD83D\uDCD6"})}),(0,a.jsxs)(l.View,{style:i.headerText,children:[a.jsx(l.Text,{style:i.title,children:"\uD83D\uDCDA Ders Bazında Gelişim"}),(0,a.jsxs)(l.Text,{style:i.subtitle,children:[s.name," - ",s.class]})]})]}),(0,a.jsxs)(l.View,{style:i.section,children:[a.jsx(l.Text,{style:i.sectionTitle,children:"\uD83D\uDCCA Ders Bazında Net Ortalamaları"}),["T\xfcrk\xe7e","Matematik","Fen","Sosyal","Din","İngilizce"].map(e=>{let t=r.filter(t=>t.studentResults[0]?.nets?.[e.toLowerCase()]>0).map(t=>({title:t.exam.title,score:t.studentResults[0]?.nets?.[e.toLowerCase()]||0,classAvg:t.exam.subjectAverages?.[e.toLowerCase()]||0}));if(0===t.length)return null;let s=t.reduce((e,t)=>e+t.score,0)/t.length,n=t.reduce((e,t)=>e+t.classAvg,0)/t.length,o=s>=n;return(0,a.jsxs)(l.View,{style:i.subjectCard,children:[(0,a.jsxs)(l.View,{style:i.subjectHeader,children:[a.jsx(l.Text,{style:i.subjectName,children:e}),(0,a.jsxs)(l.Text,{style:i.subjectScore,children:[s.toFixed(1)," net"]})]}),a.jsx(l.View,{style:i.subjectProgress,children:a.jsx(l.View,{style:[i.subjectProgressFill,{width:`${Math.min(s/20*100,100)}%`,backgroundColor:o?"#16A34A":"#F59E0B"}]})}),(0,a.jsxs)(l.View,{style:i.subjectFooter,children:[(0,a.jsxs)(l.Text,{style:i.subjectLabel,children:["Sınıf Ortalaması: ",n.toFixed(1)]}),a.jsx(l.Text,{style:[i.subjectStatus,{color:o?"#16A34A":"#F59E0B"}],children:o?"\uD83D\uDCC8 Ortalamanın \xdcst\xfcnde":"\uD83D\uDCC9 Ortalamanın Altında"})]})]},e)})]}),(0,a.jsxs)(l.Text,{style:i.footer,children:["LGS Portalı - Rapor Tarihi: ",new Date().toLocaleDateString("tr-TR")]})]}),(0,a.jsxs)(l.Page,{size:"A4",style:i.page,children:[(0,a.jsxs)(l.View,{style:i.header,children:[a.jsx(l.View,{style:i.logoContainer,children:a.jsx(l.Text,{style:i.logoText,children:"\uD83C\uDFAF"})}),(0,a.jsxs)(l.View,{style:i.headerText,children:[a.jsx(l.Text,{style:i.title,children:"\uD83C\uDFAF Hedef Takibi & Lise \xd6nerileri"}),(0,a.jsxs)(l.Text,{style:i.subtitle,children:[s.name," - ",s.class]})]})]}),(0,a.jsxs)(l.View,{style:i.section,children:[a.jsx(l.Text,{style:i.sectionTitle,children:"\uD83D\uDCCC Hedefleriniz"}),(0,a.jsxs)(l.View,{style:i.card,children:[(0,a.jsxs)(l.View,{style:i.cardRow,children:[a.jsx(l.Text,{style:i.cardLabel,children:"Hedef Puanınız"}),a.jsx(l.Text,{style:[i.cardValue,{fontSize:18,color:"#1E40AF"}],children:"450 Puan"})]}),(0,a.jsxs)(l.View,{style:i.cardRow,children:[a.jsx(l.Text,{style:i.cardLabel,children:"Son Puanınız (Yaklaşık)"}),(0,a.jsxs)(l.Text,{style:[i.cardValue,{fontSize:18,color:"#16A34A"}],children:[p," Puan"]})]}),(0,a.jsxs)(l.View,{style:[i.cardRow,i.cardRowLast],children:[a.jsx(l.Text,{style:i.cardLabel,children:"Durumunuz"}),a.jsx(l.Text,{style:[i.cardValue,{fontSize:14,color:p>=450?"#16A34A":p>=400?"#F59E0B":"#6B7280"}],children:p>=450?"\uD83C\uDF89 Hedefe Ulaştınız!":p>=400?"\uD83D\uDD25 \xc7ok Yaklaştınız!":"\uD83D\uDCAA Gelişmeye Devam!"})]})]})]}),(0,a.jsxs)(l.View,{style:i.section,children:[a.jsx(l.Text,{style:i.sectionTitle,children:"\uD83C\uDF93 \xd6nerilen Liseler (Taban Puanları)"}),(0,a.jsxs)(l.View,{style:i.table,children:[(0,a.jsxs)(l.View,{style:[i.tableRow,i.tableHeader],children:[a.jsx(l.Text,{style:[i.tableHeaderCell,{width:"55%",textAlign:"left",paddingLeft:12}],children:"Lise Adı"}),a.jsx(l.Text,{style:[i.tableHeaderCell,{width:"25%"}],children:"T\xfcr"}),a.jsx(l.Text,{style:[i.tableHeaderCell,{width:"20%"}],children:"Taban Puan"})]}),[{name:"Van T\xfcrk Telekom Fen Lisesi",type:"Fen",score:"460.91"},{name:"İpekyolu Borsa İstanbul Fen Lisesi",type:"Fen",score:"441.61"},{name:"Tuşba TOBB Fen Lisesi",type:"Fen",score:"422.90"},{name:"Niyazi T\xfcrkmenoğlu Anadolu Lisesi",type:"Anadolu",score:"416.75"},{name:"Erciş Fen Lisesi",type:"Fen",score:"402.18"},{name:"Kazım Karabekir Anadolu Lisesi",type:"Anadolu",score:"400.23"}].map((e,t)=>(0,a.jsxs)(l.View,{style:i.tableRow,children:[a.jsx(l.Text,{style:[i.tableCell,{width:"55%",textAlign:"left",paddingLeft:12}],children:e.name}),a.jsx(l.Text,{style:[i.tableCell,{width:"25%"}],children:e.type}),a.jsx(l.Text,{style:[i.tableCell,{width:"20%",fontWeight:"bold"}],children:e.score})]},t))]})]}),(0,a.jsxs)(l.Text,{style:i.footer,children:["LGS Portalı - Rapor Tarihi: ",new Date().toLocaleDateString("tr-TR")]})]})]})};r()}catch(e){r(e)}})},14506:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>F});var a=s(10326),l=s(17577),n=s(35047),i=s(30660),o=s(14958),d=s(18423),c=s(62637),x=s(9997),m=s(44675),u=s(69274),h=s(74390),g=s(1492),p=s(6845),b=s(23745),j=s(83547),y=s(39642),f=s(57130),D=e([g,p,b,j,f]);[g,p,b,j,f]=D.then?(await D)():D;let T=(0,b.initializeApp)({apiKey:"AIzaSyBYfBhkLIfjqpnL9MxBhxW6iJeC0VAEDLk",authDomain:"kopruler-basari-portali.firebaseapp.com",projectId:"kopruler-basari-portali",storageBucket:"kopruler-basari-portali.firebasestorage.app",messagingSenderId:"318334276429",appId:"1:318334276429:web:7caa5e5b9dccb564d71d04",measurementId:"G-EF6P77SMFP"}),N=(0,g.getFirestore)(T),v=e=>{let t={"2-A":[{key:"turkce",name:"T\xfcrk\xe7e",color:"#10B981",emoji:"\uD83D\uDCD6"},{key:"matematik",name:"Matematik",color:"#F59E0B",emoji:"\uD83D\uDD22"},{key:"hayat",name:"Hayat Bilgisi",color:"#8B5CF6",emoji:"\uD83C\uDF31"},{key:"ingilizce",name:"İngilizce",color:"#EF4444",emoji:"\uD83D\uDDE3️"}],"3-A":[{key:"turkce",name:"T\xfcrk\xe7e",color:"#10B981",emoji:"\uD83D\uDCD6"},{key:"matematik",name:"Matematik",color:"#F59E0B",emoji:"\uD83D\uDD22"},{key:"hayat",name:"Hayat Bilgisi",color:"#8B5CF6",emoji:"\uD83C\uDF31"},{key:"ingilizce",name:"İngilizce",color:"#EF4444",emoji:"\uD83D\uDDE3️"},{key:"fen",name:"Fen Bilimleri",color:"#3B82F6",emoji:"\uD83D\uDD2C"}],"4-A":[{key:"turkce",name:"T\xfcrk\xe7e",color:"#10B981",emoji:"\uD83D\uDCD6"},{key:"matematik",name:"Matematik",color:"#F59E0B",emoji:"\uD83D\uDD22"},{key:"sosyal",name:"Sosyal Bilgiler",color:"#8B5CF6",emoji:"\uD83C\uDF0D"},{key:"ingilizce",name:"İngilizce",color:"#EF4444",emoji:"\uD83D\uDDE3️"},{key:"din",name:"Din K\xfclt\xfcr\xfc",color:"#F97316",emoji:"\uD83D\uDD4C"},{key:"fen",name:"Fen Bilimleri",color:"#3B82F6",emoji:"\uD83D\uDD2C"}]};return t[e]||t["4-A"]};function w(){let[e,t]=(0,l.useState)(null),[s,r]=(0,l.useState)(!0),[b,D]=(0,l.useState)({}),[w,F]=(0,l.useState)(450),[T,C]=(0,l.useState)(1),[k,A]=(0,l.useState)(""),[S,B]=(0,l.useState)(""),[R,V]=(0,l.useState)(0),z=(0,l.useRef)(null),[P,E]=(0,l.useState)(!1),[L,W]=(0,l.useState)("");(0,n.useSearchParams)();let O=(0,n.useRouter)(),G=async()=>{if(e){E(!0),W("Grafikler hazırlanıyor...");try{let t=null;if(z.current)try{t=(await (0,y.default)(z.current,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"})).toDataURL("image/png")}catch(e){console.warn("Chart yakalama hatası:",e)}W("PDF oluşturuluyor...");let s=await (0,j.pdf)(a.jsx(f.Z,{reportData:e,chartImage:t})).toBlob();W("İndirme hazırlanıyor...");let r=URL.createObjectURL(s),l=document.createElement("a");l.href=r,l.download=`LGS_Rapor_${e.student.name.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),W("Tamamlandı!"),setTimeout(()=>{E(!1),W("")},1e3)}catch(e){console.error("PDF oluşturma hatası:",e),E(!1),W(""),alert("PDF oluşturulurken bir hata oluştu.")}}},I=async()=>{if(!k){B("\xd6ğrenci ID bulunamadı"),r(!1);return}r(!0),B("");try{let e=(0,g.doc)(N,"students",k),s=await (0,g.getDoc)(e);if(!s.exists())throw Error("\xd6ğrenci bulunamadı");let r={...s.data(),id:s.id},a=(0,g.query)((0,g.collection)(N,"exams"),(0,g.orderBy)("date","asc")),l=(await (0,g.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()})),n=(await (0,g.getDocs)((0,g.collection)(N,"results"))).docs.map(e=>({id:e.id,...e.data()})),i=(await (0,g.getDocs)((0,g.collection)(N,"students"))).docs.map(e=>({id:e.id,...e.data()})),o=n.filter(e=>e.studentId===k).filter(e=>("string"==typeof e.scores?.puan?parseFloat(e.scores.puan):"number"==typeof e.puan?e.puan:"number"==typeof e.totalScore?e.totalScore:0)>0),d=n.filter(e=>{let t=i.find(t=>t.id===e.studentId);return t&&t.class===r.class}),c=new Set(d.map(e=>e.examId).filter(e=>l.find(t=>t.id===e))),x=[];for(let e of Array.from(c)){let t=l.find(t=>t.id===e);if(!t)continue;let s=o.find(t=>t.examId===e);if(!s){x.push({exam:t,studentResults:[],classAverage:0,classAverageScore:0,generalAverage:0,generalAverageScore:0,studentTotalNet:0,studentTotalScore:0});continue}let a=d.filter(e=>e.examId===t.id&&i.find(t=>t.id===e.studentId)?.class===r.class),n=a.length>0?a.reduce((e,t)=>e+(t.nets?.total||0),0)/a.length:0,c=d.filter(e=>e.examId===t.id&&i.find(t=>t.id===e.studentId)?.class===r.class).filter(e=>("string"==typeof e.scores?.puan?parseFloat(e.scores.puan):"number"==typeof e.puan?e.puan:"number"==typeof e.totalScore?e.totalScore:0)>0),m=c.length>0?c.reduce((e,t)=>e+("string"==typeof t.scores?.puan?parseFloat(t.scores.puan):"number"==typeof t.puan?t.puan:"number"==typeof t.totalScore?t.totalScore:0),0)/c.length:0,u=n,h=m;if(t.generalAverages&&t.generalAverages[r.class]){let e=t.generalAverages[r.class];u=[e?.turkce||0,e?.matematik||0,e?.fen||0,e?.sosyal||0,e?.din||0,e?.ingilizce||0].reduce((e,t)=>e+t,0),e.generalScore&&(h=e.generalScore)}x.push({exam:t,studentResults:[s],classAverage:n,classAverageScore:m,generalAverage:u,generalAverageScore:h,studentTotalNet:s.nets?.total||0,studentTotalScore:"string"==typeof s.scores?.puan?parseFloat(s.scores.puan):"number"==typeof s.puan?s.puan:"number"==typeof s.totalScore?s.totalScore:0})}x.sort((e,t)=>new Date(e.exam.date).getTime()-new Date(t.exam.date).getTime());let m=await (0,p.AW)(k)||{},u=await (0,p.rO)(k);t({student:r,examResults:x,studentTargets:m}),D(m),F(u||450)}catch(e){console.error("Veri y\xfckleme hatası:",e),B("Veri y\xfckleme hatası: "+e.message)}finally{if(r(!1),k&&!S)try{await (0,p.Sh)(k)}catch(e){console.warn("View count g\xfcncellenirken hata:",e)}}};if(s)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Rapor hazırlanıyor..."})]})});if(S&&!e)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[a.jsx("h2",{className:"text-sm font-semibold text-red-800 mb-2",children:"Hata Oluştu"}),a.jsx("p",{className:"text-red-700 mb-4",children:S}),a.jsx("button",{onClick:()=>I(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Tekrar Dene"})]})})});if(!e)return a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-gray-600",children:"Rapor verisi bulunamadı."})})});let H=e.examResults.filter(e=>e.studentTotalNet>0),K=H.reduce((e,t)=>e+t.studentTotalNet,0),_=H.length>0?K/H.length:0,M=e.examResults.length>0?e.examResults.reduce((e,t)=>e+(t.classAverage||0),0)/e.examResults.length:0,q=H.length>0?H.reduce((e,t)=>e+(t.studentTotalScore||0),0)/H.length:0,U=e.examResults.length>0?e.examResults.reduce((e,t)=>e+(t.classAverageScore||0),0)/e.examResults.length:0,$=H.length>0&&H[H.length-1]?.studentTotalNet||0,X=H.length>1&&H[H.length-2]?.studentTotalNet||0,Y=$-X,Z=(()=>{if(!e.examResults||0===e.examResults.length)return 0;let t=[...e.examResults].sort((e,t)=>new Date(t.exam.date).getTime()-new Date(e.exam.date).getTime())[0].studentResults[0];if(!t)return 0;let s=t.puan;return s&&"string"==typeof s&&(s=parseFloat(s)),!s&&t.scores?.puan&&(s=t.scores.puan,"string"==typeof s&&(s=parseFloat(s))),!s&&t.totalScore&&(s=t.totalScore,"string"==typeof s&&(s=parseFloat(s))),!s&&t.nets?.total&&(s=5*t.nets.total),Math.round(s||0)})(),Q=e.examResults.map(e=>({exam:e.exam.title,öğrenci:e.studentTotalNet>0?e.studentTotalNet:null,sınıf:e.classAverage,genel:e.generalAverage})),J=e?.student?.class||"4-A";return v(J),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("img",{src:"/projelogo.png",alt:"LGS Portalı",className:"w-20 h-20 rounded-full shadow-md"}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"LGS Portalı"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:[e.student.name," - ",e.student.class]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"PDF İndir"]}),a.jsx("button",{onClick:()=>O.push("/ogrenci"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Ana Sayfa"})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-4 lg:p-6",children:[a.jsx("div",{className:"mb-6 bg-white rounded-lg shadow p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-xs font-medium text-blue-800 mb-1",children:"Sınıf"}),a.jsx("p",{className:"text-lg font-bold text-blue-600",children:e.student.class})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-xs font-medium text-green-800 mb-1",children:"Toplam Deneme"}),a.jsx("p",{className:"text-lg font-bold text-green-600",children:e.examResults.length})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-xs font-medium text-purple-800 mb-1",children:"Son Net"}),a.jsx("p",{className:"text-lg font-bold text-purple-600",children:($||0).toFixed(1)})]})]})}),0===e.examResults.length?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[a.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDCDA"}),a.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Hen\xfcz Sınav Sonucunuz Bulunmuyor"}),a.jsx("p",{className:"text-gray-600",children:"İlk sınavınızı verdikten sonra burada detaylı raporunuzu g\xf6r\xfcnt\xfcleyebilirsiniz."})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8 overflow-x-auto",children:[1,2,3,11].map(e=>(0,a.jsxs)("button",{onClick:()=>C(e),className:`py-2 px-4 border-b-2 font-medium text-xs whitespace-nowrap ${T===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[1===e&&"\uD83D\uDCCA Genel G\xf6r\xfcn\xfcm",2===e&&"\uD83D\uDCC8 Net Gelişim Trendi",3===e&&"\uD83D\uDCCA Puan Gelişim Trendi",11===e&&"\uD83D\uDCC4 PDF İndir"]},e))})})}),1===T&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Ortalama Net"}),a.jsx("p",{className:"text-sm font-bold text-blue-600",children:(_||0).toFixed(1)}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Sınıf: ",(M||0).toFixed(1)]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Ortalama Puan"}),a.jsx("p",{className:"text-sm font-bold text-green-600",children:(q||0).toFixed(0)}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Sınıf: ",(U||0).toFixed(0)]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Son Net"}),a.jsx("p",{className:"text-sm font-bold text-purple-600",children:($||0).toFixed(1)}),(0,a.jsxs)("p",{className:`text-xs mt-1 ${Y>=0?"text-green-600":"text-red-600"}`,children:[(Y||0)>=0?"+":"",(Y||0).toFixed(1)," Değişim"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Son Puan"}),a.jsx("p",{className:"text-sm font-bold text-orange-600",children:(Z||0).toFixed(0)})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-xs font-semibold text-gray-800 mb-4",children:"Net Gelişim Trendi"}),a.jsx("div",{ref:z,children:a.jsx(i.h,{width:"100%",height:300,children:(0,a.jsxs)(o.w,{data:Q,children:[a.jsx(d.q,{strokeDasharray:"3 3"}),a.jsx(c.K,{dataKey:"exam",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:10}}),a.jsx(x.B,{domain:[0,90]}),a.jsx(m.u,{formatter:e=>[`${Number(e).toFixed(1)}`,""]}),a.jsx(u.D,{}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"\xf6ğrenci",stroke:"#3B82F6",strokeWidth:2,name:"\xd6ğrenci",dot:{fill:"#3B82F6",r:4}}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"sınıf",stroke:"#10B981",strokeWidth:1,strokeDasharray:"5 5",name:"Sınıf Ortalaması"}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"genel",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"3 3",name:"Genel Ortalama"})]})})})]}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"text-left p-3 font-semibold text-gray-700",children:"Deneme"}),a.jsx("th",{className:"text-center p-3 font-semibold text-gray-700",children:"Netiniz"}),a.jsx("th",{className:"text-center p-3 font-semibold text-gray-700",children:"Sınıf Ort."}),a.jsx("th",{className:"text-center p-3 font-semibold text-gray-700",children:"Genel Ort."})]})}),a.jsx("tbody",{children:e.examResults.map((e,t)=>(0,a.jsxs)("tr",{className:"border-t",children:[a.jsx("td",{className:"p-3",children:e.exam.title}),a.jsx("td",{className:"p-3 text-center",children:e.studentTotalNet>0?e.studentTotalNet.toFixed(1):"-"}),a.jsx("td",{className:"p-3 text-center",children:e.classAverage.toFixed(1)}),a.jsx("td",{className:"p-3 text-center",children:e.generalAverage.toFixed(1)})]},t))})]})})]}),2===T&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-xs font-semibold text-gray-800 mb-4",children:"Net Gelişim Trendi"}),a.jsx("div",{ref:z,children:a.jsx(i.h,{width:"100%",height:400,children:(0,a.jsxs)(o.w,{data:Q,children:[a.jsx(d.q,{strokeDasharray:"3 3"}),a.jsx(c.K,{dataKey:"exam",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:10}}),a.jsx(x.B,{domain:[0,90]}),a.jsx(m.u,{formatter:e=>[`${Number(e).toFixed(1)}`,""]}),a.jsx(u.D,{}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"\xf6ğrenci",stroke:"#3B82F6",strokeWidth:2,name:"\xd6ğrenci",dot:{fill:"#3B82F6",r:4}}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"sınıf",stroke:"#10B981",strokeWidth:1,strokeDasharray:"5 5",name:"Sınıf Ortalaması"}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"genel",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"3 3",name:"Genel Ortalama"})]})})})]}),3===T&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[a.jsx("h3",{className:"text-xs font-semibold text-gray-800 mb-4",children:"Puan Gelişim Trendi"}),a.jsx(i.h,{width:"100%",height:400,children:(0,a.jsxs)(o.w,{data:e.examResults.map(e=>({exam:e.exam.title,öğrenci:e.studentTotalScore>0?e.studentTotalScore:null,sınıf:e.classAverageScore,genel:e.generalAverageScore})),children:[a.jsx(d.q,{strokeDasharray:"3 3"}),a.jsx(c.K,{dataKey:"exam",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:10}}),a.jsx(x.B,{domain:[0,500]}),a.jsx(m.u,{formatter:e=>[`${Number(e).toFixed(0)}`,""]}),a.jsx(u.D,{}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"\xf6ğrenci",stroke:"#8B5CF6",strokeWidth:2,name:"\xd6ğrenci Puanı",dot:{fill:"#8B5CF6",r:4}}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"sınıf",stroke:"#10B981",strokeWidth:1,strokeDasharray:"5 5",name:"Sınıf Ortalama Puan"}),a.jsx(h.x,{isAnimationActive:!1,type:"monotone",dataKey:"genel",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"3 3",name:"Genel Ortalama Puan"})]})})]}),11===T&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 rounded-lg shadow-lg",children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",children:"\uD83D\uDCC4 PDF Rapor İndir"}),a.jsx("p",{className:"text-blue-100",children:"\xd6ğrenci performans raporunu PDF olarak indirebilirsiniz"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"\uD83D\uDCCB Rapor İ\xe7eriği"}),(0,a.jsxs)("ul",{className:"space-y-2 text-blue-700",children:[(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"✓"}),"Genel performans \xf6zeti ve istatistikler"]}),(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"✓"}),"Net gelişim trendi grafiği"]}),(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"✓"}),"Deneme ge\xe7mişi tablosu"]}),(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"✓"}),"Ders bazında gelişim analizi"]}),(0,a.jsxs)("li",{className:"flex items-center",children:[a.jsx("span",{className:"mr-2",children:"✓"}),"Hedef takibi ve lise \xf6nerileri"]})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:a.jsx("button",{onClick:G,disabled:P||!e,className:`w-full py-4 px-6 rounded-lg text-white font-semibold text-lg transition-all ${P?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,children:P?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),L||"PDF Oluşturuluyor..."]}):(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"\uD83D\uDCE5 PDF İndir"]})})})]})]})]})]})}function F(){return a.jsx(l.Suspense,{fallback:a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}),children:a.jsx(w,{})})}r()}catch(e){r(e)}})},44837:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`/workspace/src/app/student-dashboard/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,347,621,171,642,13],()=>s(39904));module.exports=r})();