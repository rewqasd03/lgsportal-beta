(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[909],{42480:function(){},31910:function(e,t,s){Promise.resolve().then(s.bind(s,30161))},30161:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var l=s(57437),r=s(2265),a=s(99376),n=s(47625),i=s(21156),o=s(56940),d=s(97059),c=s(62994),x=s(8147),u=s(22190),m=s(54061),h=s(5978),g=s(34621),j=s(738),b=s(40950),f=s(24457),y=s.n(f);b.Zx.register({family:"Open Sans",fonts:[{src:"https://fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObjxOVQA-O.woff2",fontWeight:400},{src:"https://fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObjxOVQA-O.woff2",fontWeight:600},{src:"https://fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObjxOVQA-O.woff2",fontWeight:"bold"}]});let p=b.mM.create({page:{flexDirection:"column",backgroundColor:"#FFFFFF",padding:35,fontFamily:"Open Sans",fontSize:11,lineHeight:1.6},header:{flexDirection:"row",alignItems:"center",marginBottom:25,borderBottomWidth:3,borderBottomColor:"#1E40AF",paddingBottom:15},logoContainer:{width:55,height:55,backgroundColor:"#EFF6FF",borderRadius:10,justifyContent:"center",alignItems:"center",marginRight:15},logoText:{fontSize:24,color:"#1E40AF"},headerText:{flex:1},title:{fontSize:22,fontWeight:"bold",color:"#000000",marginBottom:5},subtitle:{fontSize:13,color:"#555555"},section:{marginBottom:20},sectionTitle:{fontSize:16,fontWeight:"bold",color:"#1E40AF",marginBottom:12,paddingBottom:6,borderBottomWidth:2,borderBottomColor:"#BFDBFE"},card:{backgroundColor:"#F8FAFC",borderRadius:8,padding:15,marginBottom:12,borderWidth:1,borderColor:"#E2E8F0"},cardRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#E2E8F0"},cardRowLast:{marginBottom:0,paddingBottom:0,borderBottomWidth:0},cardLabel:{fontSize:11,color:"#555555"},cardValue:{fontSize:13,fontWeight:"bold",color:"#000000"},grid:{flexDirection:"row",flexWrap:"wrap",gap:12},gridItem:{width:"48%",backgroundColor:"#EFF6FF",padding:15,borderRadius:8,marginBottom:10,borderWidth:1,borderColor:"#BFDBFE"},statValue:{fontSize:24,fontWeight:"bold",color:"#1E40AF"},statLabel:{fontSize:10,color:"#555555",marginTop:4,textTransform:"uppercase",letterSpacing:.5},table:{width:"100%",borderWidth:2,borderColor:"#1E40AF",borderRadius:6,overflow:"hidden",marginBottom:12},tableRow:{flexDirection:"row"},tableHeader:{backgroundColor:"#1E40AF"},tableHeaderCell:{padding:12,fontSize:10,fontWeight:"bold",color:"#FFFFFF",textAlign:"center"},tableCell:{padding:10,fontSize:10,color:"#000000",borderBottomWidth:1,borderBottomColor:"#E2E8F0",textAlign:"center"},tableCellFirst:{textAlign:"left",fontWeight:"600"},progressBar:{height:10,backgroundColor:"#E2E8F0",borderRadius:5,overflow:"hidden",marginTop:6},progressFill:{height:"100%",borderRadius:5},footer:{position:"absolute",bottom:25,left:35,right:35,textAlign:"center",fontSize:9,color:"#666666",borderTopWidth:1,borderTopColor:"#E2E8F0",paddingTop:10},chartImage:{width:"100%",height:220,marginVertical:12,borderRadius:6,borderWidth:1,borderColor:"#E2E8F0"},infoBox:{backgroundColor:"#FEF3C7",borderRadius:6,padding:12,marginBottom:10,borderWidth:1,borderColor:"#FCD34D"},infoText:{fontSize:10,color:"#92400E"},subjectCard:{backgroundColor:"#F8FAFC",borderRadius:6,padding:12,marginBottom:8,borderWidth:1,borderColor:"#E2E8F0"},subjectHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:6},subjectName:{fontSize:14,fontWeight:"bold",color:"#000000"},subjectScore:{fontSize:16,fontWeight:"bold",color:"#1E40AF"},subjectProgress:{height:8,backgroundColor:"#E2E8F0",borderRadius:4,overflow:"hidden"},subjectProgressFill:{height:"100%",borderRadius:4},subjectFooter:{flexDirection:"row",justifyContent:"space-between",marginTop:6},subjectLabel:{fontSize:9,color:"#555555"},subjectStatus:{fontSize:9,fontWeight:"bold"}});var v=e=>{var t,s;let{reportData:r,chartImage:a}=e;if(!r)return null;let{student:n,examResults:i}=r,o=i.filter(e=>e.studentTotalNet>0),d=o.reduce((e,t)=>e+t.studentTotalNet,0),c=o.length>0?d/o.length:0,x=o.length>0&&(null===(t=o[o.length-1])||void 0===t?void 0:t.studentTotalNet)||0,u=x-(o.length>1&&(null===(s=o[o.length-2])||void 0===s?void 0:s.studentTotalNet)||0),m=i.length>0?i.reduce((e,t)=>e+(t.classAverage||0),0)/i.length:0,h=o.length>0?o.reduce((e,t)=>e+(t.studentTotalScore||0),0)/o.length:0,g=i.length>0?i.reduce((e,t)=>e+(t.classAverageScore||0),0)/i.length:0,j=(()=>{var e,t;if(!i||0===i.length)return 0;let s=[...i].sort((e,t)=>new Date(t.exam.date).getTime()-new Date(e.exam.date).getTime())[0].studentResults[0];if(!s)return 0;let l=s.puan;return l&&"string"==typeof l&&(l=parseFloat(l)),!l&&(null===(e=s.scores)||void 0===e?void 0:e.puan)&&"string"==typeof(l=s.scores.puan)&&(l=parseFloat(l)),!l&&s.totalScore&&"string"==typeof(l=s.totalScore)&&(l=parseFloat(l)),!l&&(null===(t=s.nets)||void 0===t?void 0:t.total)&&(l=5*s.nets.total),Math.round(l||0)})();return(0,l.jsxs)(b.BB,{children:[(0,l.jsxs)(b.T3,{size:"A4",style:p.page,children:[(0,l.jsxs)(b.G7,{style:p.header,children:[(0,l.jsx)(b.G7,{style:p.logoContainer,children:(0,l.jsx)(b.xv,{style:p.logoText,children:"\uD83D\uDCCA"})}),(0,l.jsxs)(b.G7,{style:p.headerText,children:[(0,l.jsx)(b.xv,{style:p.title,children:"LGS Portalı - \xd6ğrenci Raporu"}),(0,l.jsxs)(b.xv,{style:p.subtitle,children:[n.name," - ",n.class]})]})]}),(0,l.jsxs)(b.G7,{style:p.section,children:[(0,l.jsx)(b.xv,{style:p.sectionTitle,children:"\uD83D\uDCCA Genel Performans \xd6zeti"}),(0,l.jsxs)(b.G7,{style:p.grid,children:[(0,l.jsxs)(b.G7,{style:p.gridItem,children:[(0,l.jsx)(b.xv,{style:p.statValue,children:(c||0).toFixed(1)}),(0,l.jsx)(b.xv,{style:p.statLabel,children:"Ortalama Net"})]}),(0,l.jsxs)(b.G7,{style:p.gridItem,children:[(0,l.jsx)(b.xv,{style:p.statValue,children:(x||0).toFixed(1)}),(0,l.jsx)(b.xv,{style:p.statLabel,children:"Son Net"})]}),(0,l.jsxs)(b.G7,{style:p.gridItem,children:[(0,l.jsxs)(b.xv,{style:[p.statValue,{color:u>=0?"#16A34A":"#DC2626"}],children:[(u||0)>=0?"+":"",(u||0).toFixed(1)]}),(0,l.jsx)(b.xv,{style:p.statLabel,children:"Değişim"})]}),(0,l.jsxs)(b.G7,{style:p.gridItem,children:[(0,l.jsx)(b.xv,{style:p.statValue,children:i.length}),(0,l.jsx)(b.xv,{style:p.statLabel,children:"Toplam Deneme"})]})]})]}),(0,l.jsxs)(b.G7,{style:p.section,children:[(0,l.jsx)(b.xv,{style:p.sectionTitle,children:"\uD83D\uDCC8 Sınıf Karşılaştırması"}),(0,l.jsxs)(b.G7,{style:p.card,children:[(0,l.jsxs)(b.G7,{style:p.cardRow,children:[(0,l.jsx)(b.xv,{style:p.cardLabel,children:"Ortalama Net (Sınıf Ortalaması)"}),(0,l.jsx)(b.xv,{style:p.cardValue,children:(m||0).toFixed(1)})]}),(0,l.jsxs)(b.G7,{style:p.cardRow,children:[(0,l.jsx)(b.xv,{style:p.cardLabel,children:"Ortalama Puan (Sizin)"}),(0,l.jsx)(b.xv,{style:p.cardValue,children:(h||0).toFixed(0)})]}),(0,l.jsxs)(b.G7,{style:[p.cardRow,p.cardRowLast],children:[(0,l.jsx)(b.xv,{style:p.cardLabel,children:"Ortalama Puan (Sınıf)"}),(0,l.jsx)(b.xv,{style:p.cardValue,children:(g||0).toFixed(0)})]})]})]}),a&&(0,l.jsxs)(b.G7,{style:p.section,children:[(0,l.jsx)(b.xv,{style:p.sectionTitle,children:"\uD83D\uDCC8 Net Gelişim Trendi"}),(0,l.jsx)(b.Ee,{src:a,style:p.chartImage})]}),(0,l.jsxs)(b.G7,{style:p.section,children:[(0,l.jsx)(b.xv,{style:p.sectionTitle,children:"\uD83D\uDCDA Deneme Ge\xe7mişi"}),(0,l.jsxs)(b.G7,{style:p.table,children:[(0,l.jsxs)(b.G7,{style:[p.tableRow,p.tableHeader],children:[(0,l.jsx)(b.xv,{style:[p.tableHeaderCell,{width:"40%",textAlign:"left",paddingLeft:12}],children:"Deneme Adı"}),(0,l.jsx)(b.xv,{style:[p.tableHeaderCell,{width:"20%"}],children:"Netiniz"}),(0,l.jsx)(b.xv,{style:[p.tableHeaderCell,{width:"20%"}],children:"Sınıf Ort."}),(0,l.jsx)(b.xv,{style:[p.tableHeaderCell,{width:"20%"}],children:"Genel Ort."})]}),i.slice(0,10).map((e,t)=>(0,l.jsxs)(b.G7,{style:p.tableRow,children:[(0,l.jsx)(b.xv,{style:[p.tableCell,{width:"40%",textAlign:"left",paddingLeft:12}],children:e.exam.title}),(0,l.jsx)(b.xv,{style:[p.tableCell,{width:"20%"}],children:e.studentTotalNet>0?e.studentTotalNet.toFixed(1):"-"}),(0,l.jsx)(b.xv,{style:[p.tableCell,{width:"20%"}],children:e.classAverage.toFixed(1)}),(0,l.jsx)(b.xv,{style:[p.tableCell,{width:"20%"}],children:e.generalAverage.toFixed(1)})]},t))]}),i.length>10&&(0,l.jsxs)(b.xv,{style:{fontSize:10,color:"#666666",textAlign:"center",marginTop:8},children:["...ve ",i.length-10," deneme daha"]})]}),(0,l.jsxs)(b.xv,{style:p.footer,children:["LGS Portalı - Rapor Tarihi: ",new Date().toLocaleDateString("tr-TR")]})]}),(0,l.jsxs)(b.T3,{size:"A4",style:p.page,children:[(0,l.jsxs)(b.G7,{style:p.header,children:[(0,l.jsx)(b.G7,{style:p.logoContainer,children:(0,l.jsx)(b.xv,{style:p.logoText,children:"\uD83D\uDCD6"})}),(0,l.jsxs)(b.G7,{style:p.headerText,children:[(0,l.jsx)(b.xv,{style:p.title,children:"\uD83D\uDCDA Ders Bazında Gelişim"}),(0,l.jsxs)(b.xv,{style:p.subtitle,children:[n.name," - ",n.class]})]})]}),(0,l.jsxs)(b.G7,{style:p.section,children:[(0,l.jsx)(b.xv,{style:p.sectionTitle,children:"\uD83D\uDCCA Ders Bazında Net Ortalamaları"}),["T\xfcrk\xe7e","Matematik","Fen","Sosyal","Din","İngilizce"].map(e=>{let t=i.filter(t=>{var s,l;return(null===(l=t.studentResults[0])||void 0===l?void 0:null===(s=l.nets)||void 0===s?void 0:s[e.toLowerCase()])>0}).map(t=>{var s,l,r;return{title:t.exam.title,score:(null===(l=t.studentResults[0])||void 0===l?void 0:null===(s=l.nets)||void 0===s?void 0:s[e.toLowerCase()])||0,classAvg:(null===(r=t.exam.subjectAverages)||void 0===r?void 0:r[e.toLowerCase()])||0}});if(0===t.length)return null;let s=t.reduce((e,t)=>e+t.score,0)/t.length,r=t.reduce((e,t)=>e+t.classAvg,0)/t.length,a=s>=r;return(0,l.jsxs)(b.G7,{style:p.subjectCard,children:[(0,l.jsxs)(b.G7,{style:p.subjectHeader,children:[(0,l.jsx)(b.xv,{style:p.subjectName,children:e}),(0,l.jsxs)(b.xv,{style:p.subjectScore,children:[s.toFixed(1)," net"]})]}),(0,l.jsx)(b.G7,{style:p.subjectProgress,children:(0,l.jsx)(b.G7,{style:[p.subjectProgressFill,{width:"".concat(Math.min(s/20*100,100),"%"),backgroundColor:a?"#16A34A":"#F59E0B"}]})}),(0,l.jsxs)(b.G7,{style:p.subjectFooter,children:[(0,l.jsxs)(b.xv,{style:p.subjectLabel,children:["Sınıf Ortalaması: ",r.toFixed(1)]}),(0,l.jsx)(b.xv,{style:[p.subjectStatus,{color:a?"#16A34A":"#F59E0B"}],children:a?"\uD83D\uDCC8 Ortalamanın \xdcst\xfcnde":"\uD83D\uDCC9 Ortalamanın Altında"})]})]},e)})]}),(0,l.jsxs)(b.xv,{style:p.footer,children:["LGS Portalı - Rapor Tarihi: ",new Date().toLocaleDateString("tr-TR")]})]}),(0,l.jsxs)(b.T3,{size:"A4",style:p.page,children:[(0,l.jsxs)(b.G7,{style:p.header,children:[(0,l.jsx)(b.G7,{style:p.logoContainer,children:(0,l.jsx)(b.xv,{style:p.logoText,children:"\uD83C\uDFAF"})}),(0,l.jsxs)(b.G7,{style:p.headerText,children:[(0,l.jsx)(b.xv,{style:p.title,children:"\uD83C\uDFAF Hedef Takibi & Lise \xd6nerileri"}),(0,l.jsxs)(b.xv,{style:p.subtitle,children:[n.name," - ",n.class]})]})]}),(0,l.jsxs)(b.G7,{style:p.section,children:[(0,l.jsx)(b.xv,{style:p.sectionTitle,children:"\uD83D\uDCCC Hedefleriniz"}),(0,l.jsxs)(b.G7,{style:p.card,children:[(0,l.jsxs)(b.G7,{style:p.cardRow,children:[(0,l.jsx)(b.xv,{style:p.cardLabel,children:"Hedef Puanınız"}),(0,l.jsx)(b.xv,{style:[p.cardValue,{fontSize:18,color:"#1E40AF"}],children:"450 Puan"})]}),(0,l.jsxs)(b.G7,{style:p.cardRow,children:[(0,l.jsx)(b.xv,{style:p.cardLabel,children:"Son Puanınız (Yaklaşık)"}),(0,l.jsxs)(b.xv,{style:[p.cardValue,{fontSize:18,color:"#16A34A"}],children:[j," Puan"]})]}),(0,l.jsxs)(b.G7,{style:[p.cardRow,p.cardRowLast],children:[(0,l.jsx)(b.xv,{style:p.cardLabel,children:"Durumunuz"}),(0,l.jsx)(b.xv,{style:[p.cardValue,{fontSize:14,color:j>=450?"#16A34A":j>=400?"#F59E0B":"#6B7280"}],children:j>=450?"\uD83C\uDF89 Hedefe Ulaştınız!":j>=400?"\uD83D\uDD25 \xc7ok Yaklaştınız!":"\uD83D\uDCAA Gelişmeye Devam!"})]})]})]}),(0,l.jsxs)(b.G7,{style:p.section,children:[(0,l.jsx)(b.xv,{style:p.sectionTitle,children:"\uD83C\uDF93 \xd6nerilen Liseler (Taban Puanları)"}),(0,l.jsxs)(b.G7,{style:p.table,children:[(0,l.jsxs)(b.G7,{style:[p.tableRow,p.tableHeader],children:[(0,l.jsx)(b.xv,{style:[p.tableHeaderCell,{width:"55%",textAlign:"left",paddingLeft:12}],children:"Lise Adı"}),(0,l.jsx)(b.xv,{style:[p.tableHeaderCell,{width:"25%"}],children:"T\xfcr"}),(0,l.jsx)(b.xv,{style:[p.tableHeaderCell,{width:"20%"}],children:"Taban Puan"})]}),[{name:"Van T\xfcrk Telekom Fen Lisesi",type:"Fen",score:"460.91"},{name:"İpekyolu Borsa İstanbul Fen Lisesi",type:"Fen",score:"441.61"},{name:"Tuşba TOBB Fen Lisesi",type:"Fen",score:"422.90"},{name:"Niyazi T\xfcrkmenoğlu Anadolu Lisesi",type:"Anadolu",score:"416.75"},{name:"Erciş Fen Lisesi",type:"Fen",score:"402.18"},{name:"Kazım Karabekir Anadolu Lisesi",type:"Anadolu",score:"400.23"}].map((e,t)=>(0,l.jsxs)(b.G7,{style:p.tableRow,children:[(0,l.jsx)(b.xv,{style:[p.tableCell,{width:"55%",textAlign:"left",paddingLeft:12}],children:e.name}),(0,l.jsx)(b.xv,{style:[p.tableCell,{width:"25%"}],children:e.type}),(0,l.jsx)(b.xv,{style:[p.tableCell,{width:"20%",fontWeight:"bold"}],children:e.score})]},t))]})]}),(0,l.jsxs)(b.xv,{style:p.footer,children:["LGS Portalı - Rapor Tarihi: ",new Date().toLocaleDateString("tr-TR")]})]})]})};let D=(0,j.ZF)({apiKey:"AIzaSyBYfBhkLIfjqpnL9MxBhxW6iJeC0VAEDLk",authDomain:"kopruler-basari-portali.firebaseapp.com",projectId:"kopruler-basari-portali",storageBucket:"kopruler-basari-portali.firebasestorage.app",messagingSenderId:"318334276429",appId:"1:318334276429:web:7caa5e5b9dccb564d71d04",measurementId:"G-EF6P77SMFP"}),F=(0,h.getFirestore)(D),N=e=>{let t={"2-A":[{key:"turkce",name:"T\xfcrk\xe7e",color:"#10B981",emoji:"\uD83D\uDCD6"},{key:"matematik",name:"Matematik",color:"#F59E0B",emoji:"\uD83D\uDD22"},{key:"hayat",name:"Hayat Bilgisi",color:"#8B5CF6",emoji:"\uD83C\uDF31"},{key:"ingilizce",name:"İngilizce",color:"#EF4444",emoji:"\uD83D\uDDE3️"}],"3-A":[{key:"turkce",name:"T\xfcrk\xe7e",color:"#10B981",emoji:"\uD83D\uDCD6"},{key:"matematik",name:"Matematik",color:"#F59E0B",emoji:"\uD83D\uDD22"},{key:"hayat",name:"Hayat Bilgisi",color:"#8B5CF6",emoji:"\uD83C\uDF31"},{key:"ingilizce",name:"İngilizce",color:"#EF4444",emoji:"\uD83D\uDDE3️"},{key:"fen",name:"Fen Bilimleri",color:"#3B82F6",emoji:"\uD83D\uDD2C"}],"4-A":[{key:"turkce",name:"T\xfcrk\xe7e",color:"#10B981",emoji:"\uD83D\uDCD6"},{key:"matematik",name:"Matematik",color:"#F59E0B",emoji:"\uD83D\uDD22"},{key:"sosyal",name:"Sosyal Bilgiler",color:"#8B5CF6",emoji:"\uD83C\uDF0D"},{key:"ingilizce",name:"İngilizce",color:"#EF4444",emoji:"\uD83D\uDDE3️"},{key:"din",name:"Din K\xfclt\xfcr\xfc",color:"#F97316",emoji:"\uD83D\uDD4C"},{key:"fen",name:"Fen Bilimleri",color:"#3B82F6",emoji:"\uD83D\uDD2C"}]};return t[e]||t["4-A"]};function w(){var e,t,s;let[j,f]=(0,r.useState)(null),[p,D]=(0,r.useState)(!0),[w,C]=(0,r.useState)({}),[k,A]=(0,r.useState)(450),[S,T]=(0,r.useState)(1),[B,G]=(0,r.useState)(""),[R,z]=(0,r.useState)(""),[E,L]=(0,r.useState)(0),W=(0,r.useRef)(null),[O,P]=(0,r.useState)(!1),[I,V]=(0,r.useState)(""),H=(0,a.useSearchParams)(),K=(0,a.useRouter)(),M=async()=>{if(j){P(!0),V("Grafikler hazırlanıyor...");try{let e=null;if(W.current)try{e=(await y()(W.current,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"})).toDataURL("image/png")}catch(e){console.warn("Chart yakalama hatası:",e)}V("PDF oluşturuluyor...");let t=await (0,b.eA)((0,l.jsx)(v,{reportData:j,chartImage:e})).toBlob();V("İndirme hazırlanıyor...");let s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="LGS_Rapor_".concat(j.student.name.replace(/\s+/g,"_"),"_").concat(new Date().toISOString().split("T")[0],".pdf"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s),V("Tamamlandı!"),setTimeout(()=>{P(!1),V("")},1e3)}catch(e){console.error("PDF oluşturma hatası:",e),P(!1),V(""),alert("PDF oluşturulurken bir hata oluştu.")}}};(0,r.useEffect)(()=>{let e=H.get("studentId");if(e&&e!==B)G(e),z("");else if(!e&&0===E){let e=setTimeout(()=>{L(1);let e=H.get("studentId");e?G(e):(z("\xd6ğrenci ID bulunamadı."),setTimeout(()=>K.push("/ogrenci"),3e3))},2e3);return()=>clearTimeout(e)}},[H,B,E,K]),(0,r.useEffect)(()=>{B&&_()},[B]);let _=async()=>{if(!B){z("\xd6ğrenci ID bulunamadı"),D(!1);return}D(!0),z("");try{let s=(0,h.doc)(F,"students",B),l=await (0,h.QT)(s);if(!l.exists())throw Error("\xd6ğrenci bulunamadı");let r={...l.data(),id:l.id},a=(0,h.query)((0,h.collection)(F,"exams"),(0,h.orderBy)("date","asc")),n=(await (0,h.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()})),i=(await (0,h.getDocs)((0,h.collection)(F,"results"))).docs.map(e=>({id:e.id,...e.data()})),o=(await (0,h.getDocs)((0,h.collection)(F,"students"))).docs.map(e=>({id:e.id,...e.data()})),d=i.filter(e=>e.studentId===B).filter(e=>{var t;return("string"==typeof(null===(t=e.scores)||void 0===t?void 0:t.puan)?parseFloat(e.scores.puan):"number"==typeof e.puan?e.puan:"number"==typeof e.totalScore?e.totalScore:0)>0}),c=i.filter(e=>{let t=o.find(t=>t.id===e.studentId);return t&&t.class===r.class}),x=new Set(c.map(e=>e.examId).filter(e=>n.find(t=>t.id===e))),u=[];for(let s of Array.from(x)){var e,t;let l=n.find(e=>e.id===s);if(!l)continue;let a=d.find(e=>e.examId===s);if(!a){u.push({exam:l,studentResults:[],classAverage:0,classAverageScore:0,generalAverage:0,generalAverageScore:0,studentTotalNet:0,studentTotalScore:0});continue}let i=c.filter(e=>{var t;return e.examId===l.id&&(null===(t=o.find(t=>t.id===e.studentId))||void 0===t?void 0:t.class)===r.class}),x=i.length>0?i.reduce((e,t)=>{var s;return e+((null===(s=t.nets)||void 0===s?void 0:s.total)||0)},0)/i.length:0,m=c.filter(e=>{var t;return e.examId===l.id&&(null===(t=o.find(t=>t.id===e.studentId))||void 0===t?void 0:t.class)===r.class}).filter(e=>{var t;return("string"==typeof(null===(t=e.scores)||void 0===t?void 0:t.puan)?parseFloat(e.scores.puan):"number"==typeof e.puan?e.puan:"number"==typeof e.totalScore?e.totalScore:0)>0}),h=m.length>0?m.reduce((e,t)=>{var s;return e+("string"==typeof(null===(s=t.scores)||void 0===s?void 0:s.puan)?parseFloat(t.scores.puan):"number"==typeof t.puan?t.puan:"number"==typeof t.totalScore?t.totalScore:0)},0)/m.length:0,g=x,j=h;if(l.generalAverages&&l.generalAverages[r.class]){let e=l.generalAverages[r.class];g=[(null==e?void 0:e.turkce)||0,(null==e?void 0:e.matematik)||0,(null==e?void 0:e.fen)||0,(null==e?void 0:e.sosyal)||0,(null==e?void 0:e.din)||0,(null==e?void 0:e.ingilizce)||0].reduce((e,t)=>e+t,0),e.generalScore&&(j=e.generalScore)}u.push({exam:l,studentResults:[a],classAverage:x,classAverageScore:h,generalAverage:g,generalAverageScore:j,studentTotalNet:(null===(e=a.nets)||void 0===e?void 0:e.total)||0,studentTotalScore:"string"==typeof(null===(t=a.scores)||void 0===t?void 0:t.puan)?parseFloat(a.scores.puan):"number"==typeof a.puan?a.puan:"number"==typeof a.totalScore?a.totalScore:0})}u.sort((e,t)=>new Date(e.exam.date).getTime()-new Date(t.exam.date).getTime());let m=await (0,g.AW)(B)||{},j=await (0,g.rO)(B);f({student:r,examResults:u,studentTargets:m}),C(m),A(j||450)}catch(e){console.error("Veri y\xfckleme hatası:",e),z("Veri y\xfckleme hatası: "+e.message)}finally{if(D(!1),B&&!R)try{await (0,g.Sh)(B)}catch(e){console.warn("View count g\xfcncellenirken hata:",e)}}};if(p)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-4 text-gray-600",children:"Rapor hazırlanıyor..."})]})});if(R&&!j)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-center",children:(0,l.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[(0,l.jsx)("h2",{className:"text-sm font-semibold text-red-800 mb-2",children:"Hata Oluştu"}),(0,l.jsx)("p",{className:"text-red-700 mb-4",children:R}),(0,l.jsx)("button",{onClick:()=>_(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Tekrar Dene"})]})})});if(!j)return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("p",{className:"text-gray-600",children:"Rapor verisi bulunamadı."})})});let U=j.examResults.filter(e=>e.studentTotalNet>0),X=U.reduce((e,t)=>e+t.studentTotalNet,0),Y=U.length>0?X/U.length:0,q=j.examResults.length>0?j.examResults.reduce((e,t)=>e+(t.classAverage||0),0)/j.examResults.length:0,Z=U.length>0?U.reduce((e,t)=>e+(t.studentTotalScore||0),0)/U.length:0,Q=j.examResults.length>0?j.examResults.reduce((e,t)=>e+(t.classAverageScore||0),0)/j.examResults.length:0,J=U.length>0&&(null===(e=U[U.length-1])||void 0===e?void 0:e.studentTotalNet)||0,$=J-(U.length>1&&(null===(t=U[U.length-2])||void 0===t?void 0:t.studentTotalNet)||0),ee=(()=>{var e,t;if(!j.examResults||0===j.examResults.length)return 0;let s=[...j.examResults].sort((e,t)=>new Date(t.exam.date).getTime()-new Date(e.exam.date).getTime())[0].studentResults[0];if(!s)return 0;let l=s.puan;return l&&"string"==typeof l&&(l=parseFloat(l)),!l&&(null===(e=s.scores)||void 0===e?void 0:e.puan)&&"string"==typeof(l=s.scores.puan)&&(l=parseFloat(l)),!l&&s.totalScore&&"string"==typeof(l=s.totalScore)&&(l=parseFloat(l)),!l&&(null===(t=s.nets)||void 0===t?void 0:t.total)&&(l=5*s.nets.total),Math.round(l||0)})(),et=j.examResults.map(e=>({exam:e.exam.title,öğrenci:e.studentTotalNet>0?e.studentTotalNet:null,sınıf:e.classAverage,genel:e.generalAverage}));return N((null==j?void 0:null===(s=j.student)||void 0===s?void 0:s.class)||"4-A"),(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("img",{src:"/projelogo.png",alt:"LGS Portalı",className:"w-20 h-20 rounded-full shadow-md"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"LGS Portalı"}),(0,l.jsxs)("p",{className:"text-xs text-gray-600",children:[j.student.name," - ",j.student.class]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"PDF İndir"]}),(0,l.jsx)("button",{onClick:()=>K.push("/ogrenci"),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Ana Sayfa"})]})]})})}),(0,l.jsxs)("div",{className:"max-w-7xl mx-auto p-4 lg:p-6",children:[(0,l.jsx)("div",{className:"mb-6 bg-white rounded-lg shadow p-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,l.jsx)("h3",{className:"text-xs font-medium text-blue-800 mb-1",children:"Sınıf"}),(0,l.jsx)("p",{className:"text-lg font-bold text-blue-600",children:j.student.class})]}),(0,l.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,l.jsx)("h3",{className:"text-xs font-medium text-green-800 mb-1",children:"Toplam Deneme"}),(0,l.jsx)("p",{className:"text-lg font-bold text-green-600",children:j.examResults.length})]}),(0,l.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,l.jsx)("h3",{className:"text-xs font-medium text-purple-800 mb-1",children:"Son Net"}),(0,l.jsx)("p",{className:"text-lg font-bold text-purple-600",children:(J||0).toFixed(1)})]})]})}),0===j.examResults.length?(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,l.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCDA"}),(0,l.jsx)("h3",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Hen\xfcz Sınav Sonucunuz Bulunmuyor"}),(0,l.jsx)("p",{className:"text-gray-600",children:"İlk sınavınızı verdikten sonra burada detaylı raporunuzu g\xf6r\xfcnt\xfcleyebilirsiniz."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("div",{className:"border-b border-gray-200",children:(0,l.jsx)("nav",{className:"-mb-px flex space-x-8 overflow-x-auto",children:[1,2,3,11].map(e=>(0,l.jsxs)("button",{onClick:()=>T(e),className:"py-2 px-4 border-b-2 font-medium text-xs whitespace-nowrap ".concat(S===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[1===e&&"\uD83D\uDCCA Genel G\xf6r\xfcn\xfcm",2===e&&"\uD83D\uDCC8 Net Gelişim Trendi",3===e&&"\uD83D\uDCCA Puan Gelişim Trendi",11===e&&"\uD83D\uDCC4 PDF İndir"]},e))})})}),1===S&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Ortalama Net"}),(0,l.jsx)("p",{className:"text-sm font-bold text-blue-600",children:(Y||0).toFixed(1)}),(0,l.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Sınıf: ",(q||0).toFixed(1)]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Ortalama Puan"}),(0,l.jsx)("p",{className:"text-sm font-bold text-green-600",children:(Z||0).toFixed(0)}),(0,l.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Sınıf: ",(Q||0).toFixed(0)]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Son Net"}),(0,l.jsx)("p",{className:"text-sm font-bold text-purple-600",children:(J||0).toFixed(1)}),(0,l.jsxs)("p",{className:"text-xs mt-1 ".concat($>=0?"text-green-600":"text-red-600"),children:[($||0)>=0?"+":"",($||0).toFixed(1)," Değişim"]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h3",{className:"text-xs font-medium text-gray-500 mb-2",children:"Son Puan"}),(0,l.jsx)("p",{className:"text-sm font-bold text-orange-600",children:(ee||0).toFixed(0)})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h3",{className:"text-xs font-semibold text-gray-800 mb-4",children:"Net Gelişim Trendi"}),(0,l.jsx)("div",{ref:W,children:(0,l.jsx)(n.h,{width:"100%",height:300,children:(0,l.jsxs)(i.w,{data:et,children:[(0,l.jsx)(o.q,{strokeDasharray:"3 3"}),(0,l.jsx)(d.K,{dataKey:"exam",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:10}}),(0,l.jsx)(c.B,{domain:[0,90]}),(0,l.jsx)(x.u,{formatter:e=>["".concat(Number(e).toFixed(1)),""]}),(0,l.jsx)(u.D,{}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"\xf6ğrenci",stroke:"#3B82F6",strokeWidth:2,name:"\xd6ğrenci",dot:{fill:"#3B82F6",r:4}}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"sınıf",stroke:"#10B981",strokeWidth:1,strokeDasharray:"5 5",name:"Sınıf Ortalaması"}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"genel",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"3 3",name:"Genel Ortalama"})]})})})]}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"text-left p-3 font-semibold text-gray-700",children:"Deneme"}),(0,l.jsx)("th",{className:"text-center p-3 font-semibold text-gray-700",children:"Netiniz"}),(0,l.jsx)("th",{className:"text-center p-3 font-semibold text-gray-700",children:"Sınıf Ort."}),(0,l.jsx)("th",{className:"text-center p-3 font-semibold text-gray-700",children:"Genel Ort."})]})}),(0,l.jsx)("tbody",{children:j.examResults.map((e,t)=>(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"p-3",children:e.exam.title}),(0,l.jsx)("td",{className:"p-3 text-center",children:e.studentTotalNet>0?e.studentTotalNet.toFixed(1):"-"}),(0,l.jsx)("td",{className:"p-3 text-center",children:e.classAverage.toFixed(1)}),(0,l.jsx)("td",{className:"p-3 text-center",children:e.generalAverage.toFixed(1)})]},t))})]})})]}),2===S&&(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h3",{className:"text-xs font-semibold text-gray-800 mb-4",children:"Net Gelişim Trendi"}),(0,l.jsx)("div",{ref:W,children:(0,l.jsx)(n.h,{width:"100%",height:400,children:(0,l.jsxs)(i.w,{data:et,children:[(0,l.jsx)(o.q,{strokeDasharray:"3 3"}),(0,l.jsx)(d.K,{dataKey:"exam",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:10}}),(0,l.jsx)(c.B,{domain:[0,90]}),(0,l.jsx)(x.u,{formatter:e=>["".concat(Number(e).toFixed(1)),""]}),(0,l.jsx)(u.D,{}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"\xf6ğrenci",stroke:"#3B82F6",strokeWidth:2,name:"\xd6ğrenci",dot:{fill:"#3B82F6",r:4}}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"sınıf",stroke:"#10B981",strokeWidth:1,strokeDasharray:"5 5",name:"Sınıf Ortalaması"}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"genel",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"3 3",name:"Genel Ortalama"})]})})})]}),3===S&&(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h3",{className:"text-xs font-semibold text-gray-800 mb-4",children:"Puan Gelişim Trendi"}),(0,l.jsx)(n.h,{width:"100%",height:400,children:(0,l.jsxs)(i.w,{data:j.examResults.map(e=>({exam:e.exam.title,öğrenci:e.studentTotalScore>0?e.studentTotalScore:null,sınıf:e.classAverageScore,genel:e.generalAverageScore})),children:[(0,l.jsx)(o.q,{strokeDasharray:"3 3"}),(0,l.jsx)(d.K,{dataKey:"exam",angle:-45,textAnchor:"end",height:80,interval:0,tick:{fontSize:10}}),(0,l.jsx)(c.B,{domain:[0,500]}),(0,l.jsx)(x.u,{formatter:e=>["".concat(Number(e).toFixed(0)),""]}),(0,l.jsx)(u.D,{}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"\xf6ğrenci",stroke:"#8B5CF6",strokeWidth:2,name:"\xd6ğrenci Puanı",dot:{fill:"#8B5CF6",r:4}}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"sınıf",stroke:"#10B981",strokeWidth:1,strokeDasharray:"5 5",name:"Sınıf Ortalama Puan"}),(0,l.jsx)(m.x,{isAnimationActive:!1,type:"monotone",dataKey:"genel",stroke:"#F59E0B",strokeWidth:1,strokeDasharray:"3 3",name:"Genel Ortalama Puan"})]})})]}),11===S&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 rounded-lg shadow-lg",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"\uD83D\uDCC4 PDF Rapor İndir"}),(0,l.jsx)("p",{className:"text-blue-100",children:"\xd6ğrenci performans raporunu PDF olarak indirebilirsiniz"})]}),(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-blue-800 mb-4",children:"\uD83D\uDCCB Rapor İ\xe7eriği"}),(0,l.jsxs)("ul",{className:"space-y-2 text-blue-700",children:[(0,l.jsxs)("li",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"✓"}),"Genel performans \xf6zeti ve istatistikler"]}),(0,l.jsxs)("li",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"✓"}),"Net gelişim trendi grafiği"]}),(0,l.jsxs)("li",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"✓"}),"Deneme ge\xe7mişi tablosu"]}),(0,l.jsxs)("li",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"✓"}),"Ders bazında gelişim analizi"]}),(0,l.jsxs)("li",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"mr-2",children:"✓"}),"Hedef takibi ve lise \xf6nerileri"]})]})]}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsx)("button",{onClick:M,disabled:O||!j,className:"w-full py-4 px-6 rounded-lg text-white font-semibold text-lg transition-all ".concat(O?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"),children:O?(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),I||"PDF Oluşturuluyor..."]}):(0,l.jsxs)("div",{className:"flex items-center justify-center",children:[(0,l.jsx)("svg",{className:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"\uD83D\uDCE5 PDF İndir"]})})})]})]})]})]})}function C(){return(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}),children:(0,l.jsx)(w,{})})}}},function(e){e.O(0,[358,139,337,448,496,818,282,249,943,28,250,621,971,117,744],function(){return e(e.s=31910)}),_N_E=e.O()}]);